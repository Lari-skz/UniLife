import React, { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import "./styles.css";

const CalendarAndTodo = () => {
  const [tasks, setTasks] = useState([]);
  const [task, setTask] = useState("");
  const [events, setEvents] = useState([]);
  const [selectedDate, setSelectedDate] = useState(null);
  const [event, setEvent] = useState("");

  const handleAddTask = () => {
    if (task.trim()) {
      setTasks([...tasks, { text: task, completed: false }]);
      setTask("");
    }
  };

  const handleDeleteTask = (index) => {
    const newTasks = tasks.filter((_, i) => i !== index);
    setTasks(newTasks);
  };

  const handleTaskComplete = (index) => {
    const newTasks = tasks.map((task, i) =>
      i === index ? { ...task, completed: !task.completed } : task
    );
    setTasks(newTasks);
  };

  const daysInMonth = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0).getDate();
  const firstDay = new Date(new Date().getFullYear(), new Date().getMonth(), 1).getDay();

  const handleAddEvent = () => {
    if (event.trim() && selectedDate) {
      setEvents([...events, { date: selectedDate, text: event }]);
      setEvent("");
      setSelectedDate(null);
    }
  };

  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-purple-500 to-purple-800 text-white">
      <h1 className="text-4xl font-bold mb-8">Calendar & To-Do List</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-8 w-11/12 max-w-4xl">
        {/* Calendar Section */}
        <Card className="rounded-2xl shadow-lg">
          <CardContent>
            <h2 className="text-2xl font-semibold text-center mb-4">Calendar</h2>
            <div className="grid grid-cols-7 gap-2">
              {Array.from({ length: firstDay }).map((_, index) => (
                <div key={`empty-${index}`} className="h-10"></div>
              ))}
              {Array.from({ length: daysInMonth }).map((_, index) => (
                <div
                  key={index}
                  className={`h-10 flex items-center justify-center rounded cursor-pointer ${
                    selectedDate === index + 1
                      ? "bg-purple-600"
                      : "bg-purple-300"
                  } text-purple-800 font-semibold`}
                  onClick={() => setSelectedDate(index + 1)}
                >
                  {index + 1}
                </div>
              ))}
            </div>
            <div className="mt-4">
              <input
                type="text"
                className="w-full px-4 py-2 rounded-lg text-black"
                placeholder="Add an event"
                value={event}
                onChange={(e) => setEvent(e.target.value)}
              />
              <Button
                onClick={handleAddEvent}
                className="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg mt-2"
              >
                Add Event
              </Button>
              <ul className="mt-4 space-y-2">
                {events
                  .filter((e) => e.date === selectedDate)
                  .map((e, index) => (
                    <li
                      key={index}
                      className="bg-purple-300 text-purple-800 px-4 py-2 rounded-lg"
                    >
                      {e.text}
                    </li>
                  ))}
              </ul>
            </div>
          </CardContent>
        </Card>

        {/* To-Do List Section */}
        <Card className="rounded-2xl shadow-lg">
          <CardContent>
            <h2 className="text-2xl font-semibold text-center mb-4">To-Do List</h2>
            <div className="flex gap-2 mb-4">
              <input
                type="text"
                className="flex-1 px-4 py-2 rounded-lg text-black"
                placeholder="Add a new task"
                value={task}
                onChange={(e) => setTask(e.target.value)}
              />
              <Button
                onClick={handleAddTask}
                className="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg"
              >
                Add
              </Button>
            </div>
            <ul className="space-y-2">
              {tasks.map((task, index) => (
                <li
                  key={index}
                  className="flex items-center justify-between bg-purple-300 text-purple-800 px-4 py-2 rounded-lg"
                >
                  <div className="flex items-center gap-2">
                    <input
                      type="checkbox"
                      checked={task.completed}
                      onChange={() => handleTaskComplete(index)}
                      className="form-checkbox h-5 w-5 text-purple-600"
                    />
                    <span className={task.completed ? "line-through" : ""}>{task.text}</span>
                  </div>
                  <button
                    onClick={() => handleDeleteTask(index)}
                    className="text-red-500 hover:text-red-700"
                  >
                    Delete
                  </button>
                </li>
              ))}
            </ul>
          </CardContent>
        </Card>
      </div>
    </div>
  );
};

export default CalendarAndTodo;
